<script type="text/x-iobroker" data-template-name="sql">
    <div class="row">
        <div class="col s4">
            <input type="checkbox" data-field="enabled" data-default="false"/>
            <!-- this field is mandatory, just to find out if to include this settings or not</span-->
            <span class="translate">enabled</span>
        </div>
        <div class="col s4">
            <input type="checkbox" data-field="changesOnly" data-default="true"/>
            <span class="translate">log changes only</span>
        </div>
        <div class="col s4">
            <input type="number" data-field="debounce" min="500" max="86400000" data-default="10000" />
            <label class="translate">De-bounce interval(ms)</label>
        </div>
    </div>
    <div class="row">
        <div class="col s4">
        </div>
        <div class="col s4">
            <input type="number" data-field="changesRelogInterval" min="0" max="86400000" data-default="0" />
            <label class="translate">log changes interval(s) (0 = disable)</label>
        </div>
        <div class="col s4">
            <input type="number" data-field="changesMinDelta" min="0" max="86400000" data-default="0" />
            <label class="translate">log changes minimal delta (0 = disable delta check)</label>
        </div>
    </div>
    <div class="row">
        <div class="col s4">
        </div>
        <div class="col s4">
            <select data-field="storageType" data-default="" class="sql-storageType">
                <option value=""          class="translate">Automatic</option>
                <option value="String"    class="translate">String</option>
                <option value="Number"    class="translate">Number</option>
                <option value="Boolean"   class="translate">Boolean</option>
            </select>
            <label class="translate">Store as</label>
        </div>
        <div class="col s4">
            <select data-field="retention" data-default="31536000">
                        <option value="0"           class="translate">keep forever</option>
                        <option value="63072000"    class="translate">2 years</option>
                        <option value="31536000"    class="translate">1 year</option>
                        <option value="15811200"    class="translate">6 months</option>
                        <option value="7948800"     class="translate">3 months</option>
                        <option value="2678400"     class="translate">1 months</option>
                        <option value="1209600"     class="translate">2 weeks</option>
                        <option value="604800"      class="translate">1 week</option>
                        <option value="432000"      class="translate">5 days</option>
                        <option value="259200"      class="translate">3 days</option>
                        <option value="86400"       class="translate">1 day</option>
                    </select>
            <label class="translate">Storage retention</label>
        </div>
    </div>
    <div class="row sql-counter">
        <div class="col s4">
        </div>
        <div class="col s4">
            <input type="checkbox" data-field="counter" data-default="false"/>
            <span class="translate">Counter</span>
        </div>
    </div>
    <div class="row">
        <div class="col s8">
            <input class="value" data-field="aliasId" data-default="" type="text" maxlength="255" />
            <label class="translate">aliasId</label>
        </div>
        <div class="col s4">
            <label class="translate">Alias Info</label>
        </div>
    </div>
</script>

<!-- translations -->
<script type="text/javascript">
    systemDictionary = $.extend(systemDictionary, {
        "1 day": {
            "en": "1 day",
            "de": "1 Tag",
            "ru": "1 день",
            "pt": "1 dia",
            "nl": "1 dag",
            "fr": "Un jour",
            "it": "1 giorno",
            "es": "1 día",
            "pl": "1 dzień"
        },
        "1 months": {
            "en": "1 months",
            "de": "1 Monat",
            "ru": "1 месяц",
            "pt": "1 mês",
            "nl": "1 maanden",
            "fr": "1 mois",
            "it": "1 mese",
            "es": "1 mes",
            "pl": "1 miesiąc"
        },
        "1 week": {
            "en": "1 week",
            "de": "1 Woche",
            "ru": "1 неделя",
            "pt": "1 semana",
            "nl": "1 week",
            "fr": "1 semaine",
            "it": "1 settimana",
            "es": "1 semana",
            "pl": "1 tydzień"
        },
        "1 year": {
            "en": "1 year",
            "de": "1 Jahr",
            "ru": "1 год",
            "pt": "1 ano",
            "nl": "1 jaar",
            "fr": "1 an",
            "it": "1 anno",
            "es": "1 año",
            "pl": "1 rok"
        },
        "2 weeks": {
            "en": "2 weeks",
            "de": "2 Wochen",
            "ru": "2 недели",
            "pt": "2 semanas",
            "nl": "2 weken",
            "fr": "2 semaines",
            "it": "2 settimane",
            "es": "2 semanas",
            "pl": "2 tygodnie"
        },
        "2 years": {
            "en": "2 years",
            "de": "2 Jahre",
            "ru": "2 года",
            "pt": "2 anos",
            "nl": "2 jaar",
            "fr": "2 ans",
            "it": "2 anni",
            "es": "2 años",
            "pl": "2 lata"
        },
        "3 days": {
            "en": "3 days",
            "de": "3 Tage",
            "ru": "3 дня",
            "pt": "3 dias",
            "nl": "3 dagen",
            "fr": "3 jours",
            "it": "3 giorni",
            "es": "3 días",
            "pl": "3 dni"
        },
        "3 months": {
            "en": "3 months",
            "de": "3 Monate",
            "ru": "3 месяца",
            "pt": "3 meses",
            "nl": "3 maanden",
            "fr": "3 mois",
            "it": "3 mesi",
            "es": "3 meses",
            "pl": "3 miesiące"
        },
        "5 days": {
            "en": "5 days",
            "de": "5 Tage",
            "ru": "5 дней",
            "pt": "5 dias",
            "nl": "5 dagen",
            "fr": "5 jours",
            "it": "5 giorni",
            "es": "5 dias",
            "pl": "5 dni"
        },
        "6 months": {
            "en": "6 months",
            "de": "6 Monate",
            "ru": "6 месяцев",
            "pt": "6 meses",
            "nl": "6 maanden",
            "fr": "6 mois",
            "it": "6 mesi",
            "es": "6 meses",
            "pl": "6 miesięcy"
        },
        "Store as": {
            "en": "Store as",
            "de": "Speichern als",
            "ru": "Сохранить как",
            "pt": "Armazenar como",
            "nl": "Opslaan als",
            "fr": "Magasin comme",
            "it": "Conservare come",
            "es": "Przechowuj jako",
            "pl": "Przechowuj jako"
        },
        "Automatic": {
            "en": "Automatic",
            "de": "Automatisch",
            "ru": "автоматическая",
            "pt": "Automático",
            "nl": "automatisch",
            "fr": "Automatique",
            "it": "Automatico",
            "es": "Automatycznyy",
            "pl": "Automatyczny",
            "zh-cn": "自动"
        },
        "String": {
            "en": "String",
            "de": "Zeichenfolge",
            "ru": "строка",
            "pt": "Corda",
            "nl": "Draad",
            "fr": "Chaîne",
            "it": "Stringa",
            "es": "Strunowy",
            "pl": "Strunowy"
        },
        "Number": {
            "en": "Number",
            "de": "Nummer",
            "ru": "Число",
            "pt": "Número",
            "nl": "Aantal",
            "fr": "Nombre",
            "it": "Numero",
            "es": "Numer",
            "pl": "Numer"
        },
        "Boolean": {
            "en": "Boolean",
            "de": "Boolesch",
            "ru": "логический",
            "pt": "boleano",
            "nl": "Boolean",
            "fr": "Booléen",
            "it": "booleano",
            "es": "Booleano",
            "pl": "Boolean"
        },
        "De-bounce interval(ms)": {
            "en": "Ignore changes till value stays unchanged for X Milliseconds<br>(Debounce Time)",
            "de": "Änderungen ignorieren, bis der Wert für X Millisekunden unverändert bleibt <br> (Entprellzeit)",
            "ru": "Игнорировать изменения до тех пор, пока значение не останется неизменным в течение X миллисекунд <br> (время отладки)",
            "pt": "Ignorar alterações até que o valor permaneça inalterado por X Milissegundos <br> (Tempo de Depuração)",
            "nl": "Wijzigingen negeren totdat waarde ongewijzigd blijft voor X Milliseconds <br> (Debounce Time)",
            "fr": "Ignorer les modifications jusqu'à ce que la valeur reste inchangée pour X millisecondes <br> (Debounce Time)",
            "it": "Ignora le modifiche fino a quando il valore rimane invariato per X Milliseconds <br> (Debounce Time)",
            "es": "Ignorar cambios hasta que el valor permanezca sin cambios durante X milisegundos <br> (Tiempo de rebote)",
            "pl": "Zignoruj ​​zmiany, aż wartość pozostanie niezmieniona przez X Milliseconds <br> (Czas odbicia)",
            "zh-cn": "忽略更改，直到值保持不变为X毫秒<br>（去抖时间）"
        },
        "Storage retention": {
            "en": "Storage retention",
            "de": "Storage Vorhaltezeit",
            "ru": "Сохранять в файле",
            "pt": "Retenção de armazenamento",
            "nl": "Opslag retentie",
            "fr": "Conservation du stockage",
            "it": "Conservazione di memoria",
            "es": "Retención de almacenamiento",
            "pl": "Przechowywanie danych",
            "zh-cn": "储存保留"
        },
        "enabled": {
            "en": "enabled",
            "de": "Aktiviert",
            "ru": "активно",
            "pt": "ativado",
            "nl": "ingeschakeld",
            "fr": "activée",
            "it": "abilitato",
            "es": "habilitado",
            "pl": "włączony",
            "zh-cn": "已启用"
        },
        "keep forever": {
            "en": "keep forever",
            "de": "keine automatische Löschung",
            "ru": "хранить вечно",
            "pt": "mantenha para sempre",
            "nl": "blijf voor altijd",
            "fr": "garde pour toujours",
            "it": "tienilo per sempre",
            "es": "mantener para siempre",
            "pl": "zachowaj na zawsze",
            "zh-cn": "永远保持"
        },
        "log changes interval(s) (0 = disable)": {
            "en": "still record the same values (seconds)<br>(0 = disable)",
            "de": "trotzdem gleiche Werte aufzeichnen (Sekunden) <br> (0 = deaktivieren)",
            "ru": "по-прежнему записывать те же значения (в секундах) <br> (0 = отключить)",
            "pt": "ainda gravar os mesmos valores (segundos) <br> (0 = desabilitar)",
            "nl": "nog steeds dezelfde waarden (seconden) <br> (0 = uitschakelen)",
            "fr": "toujours enregistrer les mêmes valeurs (secondes) <br> (0 = désactiver)",
            "it": "registra ancora gli stessi valori (secondi) <br> (0 = disabilita)",
            "es": "sigue registrando los mismos valores (segundos) <br> (0 = deshabilitar)",
            "pl": "nadal nagrywaj te same wartości (sekundy) <br> (0 = wyłącz)",
            "zh-cn": "仍记录相同的值（秒）<br>（0 =禁用）"
        },
        "log changes minimal delta (0 = disable delta check)": {
            "en": "Minimum difference from last value<br>(0 = disable delta check)",
            "de": "Minimale Differenz zum letzten Wert <br> (0 = Deltaprüfung deaktivieren)",
            "ru": "Минимальное отличие от последнего значения <br> (0 = отключить дельта-проверку)",
            "pt": "Diferença mínima do último valor <br> (0 = desabilitar verificação delta)",
            "nl": "Minimaal verschil met laatste waarde <br> (0 = deltablokkering uitschakelen)",
            "fr": "Différence minimale par rapport à la dernière valeur <br> (0 = désactiver la vérification delta)",
            "it": "Differenza minima dall'ultimo valore <br> (0 = disabilita il controllo delta)",
            "es": "Diferencia mínima desde el último valor <br> (0 = deshabilitar la comprobación delta)",
            "pl": "Minimalna różnica od ostatniej wartości <br> (0 = wyłącz kontrolę delta)",
            "zh-cn": "与上一个值的最小差异<br>（0 =禁用增量检查）"
        },
        "log changes only": {
            "en": "Record changes only",
            "de": "Nur Änderungen aufzeichnen",
            "ru": "Запись только изменений",
            "pt": "Registrar apenas alterações",
            "nl": "Wijzigingen alleen registreren",
            "fr": "Enregistrer les modifications uniquement",
            "it": "Registra solo le modifiche",
            "es": "Registrar solo cambios",
            "pl": "Zapisz tylko zmiany",
            "zh-cn": "仅记录更改"
        },
        "maximum datapoint count in RAM": {
            "en": "maximum datapoint count in RAM",
            "de": "maximale Anzahl Datenpunkte in RAM",
            "ru": "макс. кол-во значений в RAM памяти",
            "pt": "contagem máxima do datapoint na RAM",
            "nl": "maximum aantal datapunten in RAM",
            "fr": "nombre de points de données maximum en RAM",
            "it": "massimo conteggio dei punti di accesso nella RAM",
            "es": "recuento máximo de datos en RAM",
            "pl": "maksymalna liczba punktów w pamięci RAM",
            "zh-cn": "RAM中的最大数据点数"
        },
        "aliasId": {
            "en": "Alias-ID",
            "de": "Alias-ID",
            "ru": "Псевдоним ИД",
            "pt": "Alias-ID",
            "nl": "Alias-ID",
            "fr": "Alias-ID",
            "it": "Alias-ID",
            "es": "Alias-ID",
            "pl": "Alias-ID",
            "zh-cn": "别名ID"
        },
        "Alias Info": {
            "en": "if Alias-ID is set, the data will be logged as this ID in database",
            "de": "Wenn Alias-ID gesetzt ist, werden die Daten als diese ID in der Datenbank protokolliert",
            "ru": "если установлен Alias-ID, данные будут регистрироваться как этот идентификатор в базе данных",
            "pt": "Se o Alias-ID for definido, os dados serão registrados como esse ID no banco de dados",
            "nl": "als Alias-ID is ingesteld, worden de gegevens als deze ID geregistreerd in de database",
            "fr": "Si Alias-ID est défini, les données seront enregistrées comme cet ID dans la base de données",
            "it": "se Alias-ID è impostato, i dati verranno registrati come questo ID nel database",
            "es": "si se establece Alias-ID, los datos se registrarán como esta ID en la base de datos",
            "pl": "jeśli ustawiony jest Alias-ID, dane będą rejestrowane jako identyfikator w bazie danych",
            "zh-cn": "如果设置了Alias-ID，则数据将以此ID记录在数据库中"
        },
        "Counter": {
            "en": "Counter",
            "de": "Zähler",
            "ru": "счетчик",
            "pt": "Contador",
            "nl": "Teller",
            "fr": "Compteur",
            "it": "contatore",
            "es": "Mostrador",
            "pl": "Licznik",
            "zh-cn": "计数器"
        }
    });
    // There are two ways how to predefine default settings:
    // - with attribute "data-default" (content independent)
    // - with function in global variable "defaults". Function name is equal with adapter name.
    //   as input function receives object with all information concerning it
    if (typeof defaults !== 'undefined') {
        defaults.sql = function (obj, instanceObj) {
            if (obj && obj.common && obj.common.type !== 'number') {
                return {
                    enabled:                false,
                    changesOnly:            false,
                    debounce:               0,
                    retention:              instanceObj.native.retention,
                    changesRelogInterval:   instanceObj.native.changesRelogInterval,
                    changesMinDelta:        0,
                    storageType:            '',
                    aliasId:                ''
                };
            } else {
                return {
                    enabled:                false,
                    changesOnly:            true,
                    debounce:               instanceObj.native.debounce,
                    retention:              instanceObj.native.retention,
                    changesRelogInterval:   instanceObj.native.changesRelogInterval,
                    changesMinDelta:        instanceObj.native.changesMinDelta,
                    storageType:            '',
                    aliasId:                ''
                };
            }
        }
    }

    if (typeof customPostInits !== 'undefined') {
        customPostInits.sql = function ($tab, settings, instanceObj, type, role, obj) {
            $tab.find('.sql-storageType').on('change', function () {
                var val = $(this).val();
                if (val === 'Number') {
                    $tab.find('.sql-counter').show();
                } else {
                    $tab.find('.sql-counter').hide();
                }
            });
            if (settings.type && settings.type !== 'Number') {
                $tab.find('.sql-counter').hide();
            } else {
                $tab.find('.sql-counter').show();
            }
        }
    }
</script>
